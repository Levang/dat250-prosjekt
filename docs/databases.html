<!DOCTYPE html>
<html lang="en" xml:lang="en">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Databases | DAT250 - Information security - Project report</title>
  <meta name="description" content="Project report" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Databases | DAT250 - Information security - Project report" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Project report" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Databases | DAT250 - Information security - Project report" />
  
  <meta name="twitter:description" content="Project report" />
  



<meta name="date" content="2020-10-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="structure.html"/>
<link rel="next" href="users.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />












</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="structure.html"><a href="structure.html"><i class="fa fa-check"></i><b>1</b> Structure</a></li>
<li class="chapter" data-level="2" data-path="databases.html"><a href="databases.html"><i class="fa fa-check"></i><b>2</b> Databases</a>
<ul>
<li class="chapter" data-level="2.1" data-path="databases.html"><a href="databases.html#databases-users"><i class="fa fa-check"></i><b>2.1</b> Users</a></li>
<li class="chapter" data-level="2.2" data-path="databases.html"><a href="databases.html#databases-accounts"><i class="fa fa-check"></i><b>2.2</b> Accounts</a></li>
<li class="chapter" data-level="2.3" data-path="databases.html"><a href="databases.html#databases-transactions"><i class="fa fa-check"></i><b>2.3</b> Transactions</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="users.html"><a href="users.html"><i class="fa fa-check"></i><b>3</b> Users</a></li>
<li class="chapter" data-level="4" data-path="registration.html"><a href="registration.html"><i class="fa fa-check"></i><b>4</b> Registration</a></li>
<li class="chapter" data-level="5" data-path="authentication.html"><a href="authentication.html"><i class="fa fa-check"></i><b>5</b> Authentication</a></li>
<li class="chapter" data-level="6" data-path="accounts.html"><a href="accounts.html"><i class="fa fa-check"></i><b>6</b> Accounts</a></li>
<li class="chapter" data-level="7" data-path="transactions.html"><a href="transactions.html"><i class="fa fa-check"></i><b>7</b> Transactions</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">DAT250 - Information security - Project report</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="databases" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Databases</h1>
<p>Our databases are designed with the assumption that a malicious actor gets a hold of all of them and knows our source code. In a perfect world they would not be able to use any of this to extract any valuable information.</p>
<p>The weakpoint is the fact that if an account number is known and an attacker has a hold of the <strong>Accounts</strong> database, it is very simple to look up the account balance. After five minutes of thinking, this problem seems unsolvable.</p>
<p>Some notation:</p>
<ul>
<li><code>(a)</code> means the hash of <code>a</code> is stored.</li>
<li><code>((a))</code> means an encrypted form of <code>a</code> is stored.</li>
</ul>
<div id="databases-users" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Users</h2>
<p>Users is a database of registered users, their <code>2fa_secret</code> key, and their accounts and the keys to control those accounts. None of the sensitive information in this database should ever be stored in a plaintext state. It should optimally be cryptographically hashed, but for data that is not user supplied, at least encrypted using the information supplied by the user. Doing it that way means we get to encrypt user data and not store the key anywhere.</p>
<pre><code>(email)  (pw+salt)  salt  n  ((2fa_secret))  ((accs+priv_keys))</code></pre>
<ul>
<li><p><code>email</code> is the users identifier. It is stored in a cryptographically hashed state to allow for the plaintext email to be used as part of an encryption key. This also increases security because the only way to find out which emails are registered is to brute force all emails which should hopefully take a long time because the hash is cryptographic. This comes at the cost of not knowing what emails are registered so any email notifications are impossible except for something like “There were multiple failed attempts at signing into your account” since the attacker actually provides the email in this case.</p></li>
<li><p><code>pw</code> is the users password. It is stored as a cryptographical hash of itself prepended to a salt. This prevents rainbow table attacks on the database.</p></li>
<li><p><code>salt</code> is the only thing stored in plaintext and is a cryptographically random number.</p></li>
<li><p><code>n</code> is the number of failed login attempts since the previous successful login.</p></li>
<li><p><code>2fa_secret</code> is the secret key used to generate One Time Passcodes (OTP’s). It is encrypted using the users email and password.</p></li>
<li><p><code>n_accs</code> is simply the number of accounts the user has. It is encrypted using the users email and password.</p></li>
<li><p><code>accs+priv_keys</code> is simply a long list containing all account numbers associated with the user and the private key associated with that account. It is encrypted using the users email and password.</p></li>
</ul>
</div>
<div id="databases-accounts" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Accounts</h2>
<p>Accounts is a database containing all banking accounts registered and their balance. Accounts should be borderline “use and dispose” meaning they should be easy to create and not limited in supply.</p>
<pre><code>(acc)  public_key  balance</code></pre>
<ul>
<li><p><code>acc</code> is the account number. It is stored as a cryptograhpical hash. This allows us to prevent a class of attacks where an account of interesting balance can be associated with some account number in any other way than testing every account number until a match is made. It is of course simple to check the balance of any known account number.</p></li>
<li><p><code>public_key</code> is the public key associated with the account. It is used to verify transactions from the account.</p></li>
<li><p><code>balance</code> is simply the balance of the account.</p></li>
</ul>
</div>
<div id="databases-transactions" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Transactions</h2>
<p>Transactions is a database containing all transactions that have been performed ever. It should contain no sensitive information.</p>
<pre><code>uid  date  timeout  (from)  (to)  amount  sign</code></pre>
<ul>
<li><p><code>uid</code> is a unique transaction id associated with the account. This is included to make sure a signed transaction can only be counted once.</p></li>
<li><p><code>date</code> is the timestamp of when the transaction was made. Probably UNIX time.</p></li>
<li><p><code>timeout</code> is a timestamp of when the transaction should expire. This prevents transactions that fail being reused by a bad actor some time in the future.</p></li>
<li><p><code>from</code> is the account number that is transferring. It is stored as a cryptographic hash to prevent the backtracking discussed earlier.</p></li>
<li><p><code>to</code> is the account number that is receiving. It is stored as a cryptographic hash to prevent the backtracking discussed earlier.</p></li>
<li><p><code>amount</code> is the amount that is transferring. Note that this can not be more than the balance of the <code>from</code> account.</p></li>
<li><p><code>sign</code> is the signature of the transaction, signed with the <code>private_key</code> of the <code>from</code> account. If the transaction is changed in any way then this signature must also change, preventing transactions being reused.</p></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="structure.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="users.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
